{"version":1,"windowDimensions":{"x":-1928,"y":-8,"width":1936,"height":1176,"maximized":true},"grammars":{"grammarOverridesByPath":{}},"project":{"deserializer":"Project","paths":["C:\\Temp\\ocr1A82.tmp\\src\\cafe_installer.rb"],"buffers":[{"id":"cde32bdc145b283cef9679a896abb7c2","text":"#!/usr/bin/env ruby\n\n#This one click installer installs the following:\n# 1. RailsInstaller\n# 2. CMS Automation Gem\n# 3. Gherkin Editor\n\n\n## Check if ruby is installed\n# tell user they have ruby installed so skipping Rails installer\n#\n# Check if cms_automation is installed\n# tell user they have gem installed so skipping its installation\n#\n# Install Gherkin Editor\n# CURRENT RAILS INSTALLER VERSION: railsintaller-3.1.0.exe\n# https://s3.amazonaws.com/railsinstaller/Windows/railsinstaller-3.1.0.exe\n#\n#\n# BUILD INSTRUCTIONS:\n#\n# Install the ocra gem with:\n#\n# gem install ocra\n#\n# Download the RAILS INSTALLER from the Link Above in the current dir\n#\n# Connect to the CGI VPN Network, verify access to rubygems.cgifederal.com\n#\n# Then run:\n#\n# ocra cafe_installer.rb railsintaller.exe\n#\n# The published file is cafe_installer.exe\nrequire 'net/http'\nrequire 'dl'\n#require 'debugger'\nclass CafeInstaller\n  # button constants\n  BUTTONS_OK = 0\n  BUTTONS_OKCANCEL = 1\n  BUTTONS_ABORTRETRYIGNORE = 2\n  BUTTONS_YESNO = 4\n\n  # return code constants\n  CLICKED_OK = 1\n  CLICKED_CANCEL = 2\n  CLICKED_ABORT = 3\n  CLICKED_RETRY = 4\n  CLICKED_IGNORE = 5\n  CLICKED_YES = 6\n  CLICKED_NO = 7\n  APP_TITLE ='CAFE Installer'\n\n  # Gem Constants\n  GEM_NAME = 'cafe'\n  DEBUG = false\n  DEVEL=false\n  PREFERRED_RUBY_VERSION=\"2.1.5p273\"\n\n  class << self\n    def install(old_installation=true)\n      puts \"Installing CAFE\" if DEBUG\n      install_cafe\n    end\n\n    def framework_installed?\n      begin\n        puts \"Running cafe testinstall\" if DEBUG\n        result = run('cafe -v')\n        !(result.empty? || result.nil?)\n      rescue\n        false\n      end\n    end\n\n    def install_cafe\n      require 'fileutils'\n      temp_dir = File.join('C:', 'Sites', 'cafe-installer-temp-dir')\n      FileUtils::mkdir_p temp_dir\n      File.open(File.join(temp_dir, 'Gemfile'), 'w') { |file| file.write(\"source 'http://rubygems.org'\\ngem 'cafe'\") }\n      c_dir = Dir.pwd\n      Dir.chdir temp_dir\n      run(\"cd #{temp_dir} && bundle install\")\n      Dir.chdir c_dir\n      run(\"gem install cafe --source http://rubygems.org\")\n      FileUtils.rm_rf(temp_dir)\n      framework_post_install\n    end\n\n\n    def run(command, without_output=false)\n      command = \"#{command} >nul 2>&1\" if without_output\n      puts \"running #{command}\" if DEBUG\n      `#{command}`\n    end\n\n\n    def framework_post_install\n      sleep 5\n      if framework_installed?\n        message = \"Successfully installed the Automation Framework!!\"\n\n      else\n        message =  \"Could not install the gem correctly\"\n      end\n      puts message\n      alert message\n    end\n\n    def alert(txt, title=APP_TITLE, buttons=BUTTONS_OK)\n      user32 = DL.dlopen('user32')\n      msgbox = DL::CFunc.new(user32['MessageBoxA'], DL::TYPE_LONG, title)\n      msgbox.call([0, txt, title,buttons].pack('L!ppL!').unpack('L!*'))\n    end\n\n    def ask_user(txt, title=APP_TITLE, buttons=BUTTONS_YESNO)\n      alert(txt, title, buttons)\n    end\n  end\n\nend\n\nCafeInstaller.install\n\n\n","defaultMarkerLayerId":"0","markerLayers":{"0":{"id":"0","maintainHistory":false,"markersById":{},"version":2},"1":{"id":"1","maintainHistory":false,"markersById":{},"version":2},"2":{"id":"2","maintainHistory":true,"markersById":{"1":{"range":{"start":{"row":71,"column":12},"end":{"row":71,"column":12}},"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":true,"valid":true,"invalidate":"never"}},"version":2},"4":{"id":"4","maintainHistory":false,"markersById":{},"version":2}},"nextMarkerLayerId":5,"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"C:\\Temp\\ocr1A82.tmp\\src\\cafe_installer.rb","digestWhenLastPersisted":"edcb8461acbf753be3aac3e0c439cbad3bc2b90d","preferredLineEnding":null,"nextMarkerId":2,"deserializer":"TextBuffer","version":5}]},"workspace":{"deserializer":"Workspace","paneContainer":{"deserializer":"PaneContainer","version":1,"root":{"deserializer":"Pane","id":3,"items":[{"deserializer":"TextEditor","id":4,"softTabs":true,"firstVisibleScreenRow":62,"firstVisibleScreenColumn":0,"displayBuffer":{"deserializer":"DisplayBuffer","id":5,"softWrapped":false,"tokenizedBuffer":{"deserializer":"TokenizedBuffer","bufferPath":"C:\\Temp\\ocr1A82.tmp\\src\\cafe_installer.rb","bufferId":"cde32bdc145b283cef9679a896abb7c2","largeFileMode":false},"largeFileMode":false,"foldsMarkerLayerId":"1"},"selectionsMarkerLayerId":"2"}],"activeItemURI":"C:\\Temp\\ocr1A82.tmp\\src\\cafe_installer.rb","focused":true,"flexScale":1},"activePaneId":3},"packagesWithActiveGrammars":["language-ruby","language-hyperlink","language-todo"],"destroyedItemURIs":["C:\\cafe\\myproj\\features\\support\\config\\environments.yml","C:\\RailsInstaller\\Ruby2.1.0\\bin\\cafe.bat","C:\\cafe\\myproj\\features\\support\\config\\settings.yml"]},"packageStates":{"fuzzy-finder":{"C:\\Temp\\ocr1A82.tmp\\src\\cafe_installer.rb":1459372497383},"metrics":{"sessionLength":12817076},"tree-view":{"directoryExpansionStates":{"C:\\Temp\\ocr1A82.tmp\\src\\cafe_installer.rb":{"isExpanded":true,"entries":{}}},"selectedPath":"C:\\Temp\\ocr1A82.tmp\\src\\cafe_installer.rb","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}},"fullScreen":false}